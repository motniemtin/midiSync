{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///www/wwwroot/pianosync.com/src/app/%28DashboardLayout%29/test/AlphaTabViewer.tsx"],"sourcesContent":["\"use client\";\n\nimport { useRef, useEffect } from \"react\";\nimport { AlphaTabApi, Settings, LayoutMode } from \"@coderline/alphatab\";\nimport '@/remotion/player.css';\nimport { Box } from '@mui/material';\n\ninterface AlphaTabViewerProps {\n  xmlPath: string;\n  layoutMode?: 'page' | 'horizontal';\n  onScoreLoaded?: (score: any) => void;\n  onPlayerPositionChanged?: (e: any) => void;\n}\n\nexport const AlphaTabViewer = ({ xmlPath, onScoreLoaded, onPlayerPositionChanged, layoutMode = 'horizontal' }: AlphaTabViewerProps) => {\n  const elementRef = useRef<HTMLDivElement>(null);\n  const apiRef = useRef<AlphaTabApi | null>(null);\n  useEffect(() => {\n    if (!elementRef.current || !xmlPath) return;\n\n    const baseUrl = window.location.origin;\n    const settings: Settings = {\n      core: {\n        fontDirectory: `${baseUrl}/alphaTab/font/`,\n        scriptFile: `${baseUrl}/alphaTab/alphaTab.js`\n      },\n      player: {\n        enablePlayer: true,\n        enableCursor: true,\n        soundFont: `${baseUrl}/alphaTab/soundfont/sonivox.sf2`\n      }\n    };\n\n    const api = new AlphaTabApi(elementRef.current!, settings);\n    apiRef.current = api;\n\n    if (onScoreLoaded) {\n      apiRef.current.scoreLoaded.on(onScoreLoaded);\n    }\n    if (onPlayerPositionChanged) {\n      apiRef.current.playerPositionChanged.on(onPlayerPositionChanged);\n    }\n\n    // Sử dụng prop xmlPath để load file nhạc\n    apiRef.current.load(xmlPath);\n\n    return () => {\n      if (apiRef.current) {\n        apiRef.current?.destroy();\n      }\n    };\n  }, [xmlPath, onScoreLoaded, onPlayerPositionChanged]);\n  return (\n    <Box sx={{ width: '100%', position: 'relative', paddingTop: '56.25%' }}>\n      {/* 16:9 = 9/16 = 0.5625 => 56.25% */}\n      <Box\n        sx={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          backgroundColor: 'lightblue',\n        }}\n      >\n        <div ref={elementRef} style={{ width: '100%', height: '100%' }} />;\n      </Box>\n    </Box>\n  );\n};"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAEA;;;AALA;;;;;AAcO,MAAM,iBAAiB,CAAC,EAAE,OAAO,EAAE,aAAa,EAAE,uBAAuB,EAAE,aAAa,YAAY,EAAuB;;IAChI,MAAM,aAAa,IAAA,uKAAM,EAAiB;IAC1C,MAAM,SAAS,IAAA,uKAAM,EAAqB;IAC1C,IAAA,0KAAS;oCAAC;YACR,IAAI,CAAC,WAAW,OAAO,IAAI,CAAC,SAAS;YAErC,MAAM,UAAU,OAAO,QAAQ,CAAC,MAAM;YACtC,MAAM,WAAqB;gBACzB,MAAM;oBACJ,eAAe,GAAG,QAAQ,eAAe,CAAC;oBAC1C,YAAY,GAAG,QAAQ,qBAAqB,CAAC;gBAC/C;gBACA,QAAQ;oBACN,cAAc;oBACd,cAAc;oBACd,WAAW,GAAG,QAAQ,+BAA+B,CAAC;gBACxD;YACF;YAEA,MAAM,MAAM,IAAI,sLAAW,CAAC,WAAW,OAAO,EAAG;YACjD,OAAO,OAAO,GAAG;YAEjB,IAAI,eAAe;gBACjB,OAAO,OAAO,CAAC,WAAW,CAAC,EAAE,CAAC;YAChC;YACA,IAAI,yBAAyB;gBAC3B,OAAO,OAAO,CAAC,qBAAqB,CAAC,EAAE,CAAC;YAC1C;YAEA,yCAAyC;YACzC,OAAO,OAAO,CAAC,IAAI,CAAC;YAEpB;4CAAO;oBACL,IAAI,OAAO,OAAO,EAAE;wBAClB,OAAO,OAAO,EAAE;oBAClB;gBACF;;QACF;mCAAG;QAAC;QAAS;QAAe;KAAwB;IACpD,qBACE,6LAAC,2LAAG;QAAC,IAAI;YAAE,OAAO;YAAQ,UAAU;YAAY,YAAY;QAAS;kBAEnE,cAAA,6LAAC,2LAAG;YACF,IAAI;gBACF,UAAU;gBACV,KAAK;gBACL,MAAM;gBACN,OAAO;gBACP,QAAQ;gBACR,iBAAiB;YACnB;;8BAEA,6LAAC;oBAAI,KAAK;oBAAY,OAAO;wBAAE,OAAO;wBAAQ,QAAQ;oBAAO;;;;;;gBAAK;;;;;;;;;;;;AAI1E;GAvDa;KAAA","debugId":null}},
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":["file:///www/wwwroot/pianosync.com/src/app/%28DashboardLayout%29/test/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useTranslation } from 'react-i18next';\nimport { useState, useCallback } from 'react';\nimport { AlphaTabViewer } from './AlphaTabViewer';\nimport PageContainer from '@/app/(DashboardLayout)/components/container/PageContainer';\nimport Breadcrumb from '@/app/(DashboardLayout)/layout/shared/breadcrumb/Breadcrumb';\nimport Box from '@mui/material/Box';\nimport './player.css';\n\nexport default function Test() {\n    const { t } = useTranslation();\n    const [score, setScore] = useState(null);\n    const [notesJson, setNotesJson] = useState(null);\n\n    // Thay thế bằng đường dẫn thực tế đến file xml của bạn\n    const xmlPath = \"/windy_hill.musicxml\";\n\n    const handleScoreLoaded = useCallback((loadedScore: any) => {\n        setScore(loadedScore);\n        try {\n            const _notesJson: any = {};\n            const track = loadedScore.tracks[0];\n            let _tempo = 120;\n            let _currentTime = 0;\n\n            track.staves.forEach((stave: any) => {\n                stave.bars.forEach((bar: any) => {\n                    if (loadedScore.masterBars[bar.index].tempoAutomation) {\n                        _tempo = loadedScore.masterBars[bar.index].tempoAutomation.value;\n                    }\n                    bar.voices.forEach((voice: any) => {\n                        voice.beats.forEach((beat: any) => {\n                            const _duration = ((beat.playbackDuration * (60000.0 / (_tempo * 960))) | 0) / 1000;\n                            beat.notes.forEach((note: any) => {\n                                if (typeof _notesJson[note.displayValue] === \"undefined\") {\n                                    _notesJson[note.displayValue] = [];\n                                }\n                                _notesJson[note.displayValue].push({ start: _currentTime, stop: _currentTime + _duration, fret: note.fret, string: note.string });\n                            });\n                            _currentTime += _duration;\n                        });\n                    });\n                });\n            });\n            setNotesJson(_notesJson);\n            console.log(\"Notes JSON created:\", _notesJson);\n        } catch (e) {\n            console.error(\"Error processing score:\", e);\n        }\n    }, []);\n\n    const handlePlayerPositionChanged = useCallback((e: any) => {\n        // Xử lý khi vị trí player thay đổi, ví dụ: console.log(e.currentTime);\n    }, []);\n\n    return (\n        <Box>\n            <AlphaTabViewer\n                xmlPath={xmlPath}\n                onScoreLoaded={handleScoreLoaded}\n                onPlayerPositionChanged={handlePlayerPositionChanged}\n                layoutMode='horizontal'\n            />\n        </Box>\n    );\n}"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;AAGA;;;AAPA;;;;;;AAUe,SAAS;;IACpB,MAAM,EAAE,CAAC,EAAE,GAAG,IAAA,qLAAc;IAC5B,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,uDAAuD;IACvD,MAAM,UAAU;IAEhB,MAAM,oBAAoB,IAAA,4KAAW;+CAAC,CAAC;YACnC,SAAS;YACT,IAAI;gBACA,MAAM,aAAkB,CAAC;gBACzB,MAAM,QAAQ,YAAY,MAAM,CAAC,EAAE;gBACnC,IAAI,SAAS;gBACb,IAAI,eAAe;gBAEnB,MAAM,MAAM,CAAC,OAAO;2DAAC,CAAC;wBAClB,MAAM,IAAI,CAAC,OAAO;mEAAC,CAAC;gCAChB,IAAI,YAAY,UAAU,CAAC,IAAI,KAAK,CAAC,CAAC,eAAe,EAAE;oCACnD,SAAS,YAAY,UAAU,CAAC,IAAI,KAAK,CAAC,CAAC,eAAe,CAAC,KAAK;gCACpE;gCACA,IAAI,MAAM,CAAC,OAAO;2EAAC,CAAC;wCAChB,MAAM,KAAK,CAAC,OAAO;mFAAC,CAAC;gDACjB,MAAM,YAAY,CAAC,AAAC,KAAK,gBAAgB,GAAG,CAAC,UAAU,CAAC,SAAS,GAAG,CAAC,IAAK,CAAC,IAAI;gDAC/E,KAAK,KAAK,CAAC,OAAO;2FAAC,CAAC;wDAChB,IAAI,OAAO,UAAU,CAAC,KAAK,YAAY,CAAC,KAAK,aAAa;4DACtD,UAAU,CAAC,KAAK,YAAY,CAAC,GAAG,EAAE;wDACtC;wDACA,UAAU,CAAC,KAAK,YAAY,CAAC,CAAC,IAAI,CAAC;4DAAE,OAAO;4DAAc,MAAM,eAAe;4DAAW,MAAM,KAAK,IAAI;4DAAE,QAAQ,KAAK,MAAM;wDAAC;oDACnI;;gDACA,gBAAgB;4CACpB;;oCACJ;;4BACJ;;oBACJ;;gBACA,aAAa;gBACb,QAAQ,GAAG,CAAC,uBAAuB;YACvC,EAAE,OAAO,GAAG;gBACR,QAAQ,KAAK,CAAC,2BAA2B;YAC7C;QACJ;8CAAG,EAAE;IAEL,MAAM,8BAA8B,IAAA,4KAAW;yDAAC,CAAC;QAC7C,uEAAuE;QAC3E;wDAAG,EAAE;IAEL,qBACI,6LAAC,6JAAG;kBACA,cAAA,6LAAC,iLAAc;YACX,SAAS;YACT,eAAe;YACf,yBAAyB;YACzB,YAAW;;;;;;;;;;;AAI3B;GAxDwB;;QACN,qLAAc;;;KADR","debugId":null}}]
}